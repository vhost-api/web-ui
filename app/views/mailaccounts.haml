.table-wrapper
  %table.table.table-triped
    %caption MailAccounts
    %thead
      %tr
        %th< ID
        %th< Enabled
        %th< Email Address
        %th< Realname
        %th< Receiving
        %th< Usage
        %th{ style: 'text-align: right;' }< Quota
        %th<
    %tbody
      - @result.each_value do |mailaccount|
        - acc_id = mailaccount['id']
        - edit_link = "/mail/accounts/#{acc_id}/edit"
        - en = 'icon-check item-enabled'
        - dis = 'icon-cross item-disabled'
        - en_suff = mailaccount['enabled'] ? en : dis
        - en_textval = mailaccount['enabled'] ? ' yes' : ' no'
        - rcv_suff = mailaccount['receiving_enabled'] ? en : dis
        - rcv_textval = mailaccount['receiving_enabled'] ? ' yes' : ' no'
        - a_del = "/mail/accounts/#{mailaccount['id']}/delete"
        - quota_pretty = Filesize.from("#{mailaccount['quota'].to_i} B").pretty
        - progress_class = 'progress-bar progress-bar-info'
        - thresh_warn = settings.threshholds[:display][:mailquota_warn]
        - thresh_crit = settings.threshholds[:display][:mailquota_crit]
        - if mailaccount['quotausage_rel'] >= thresh_warn
          - progress_class = 'progress-bar progress-bar-warning'
        - if mailaccount['quotausage_rel'] >= thresh_crit
          - progress_class = 'progress-bar progress-bar-danger'
        %tr
          %td<= acc_id
          %td.icon{ class: en_suff }= en_textval
          %td<
            %a{ href: edit_link }<= mailaccount['email']
          %td<= mailaccount['realname']
          %td.icon{ class: rcv_suff }= rcv_textval
          %td<
            .progress<
              %div{ class: progress_class,
                    'role': 'progress',
                    'aria-valuemin': '0',
                    'aria-valuemax': '100',
                    style: "width:#{mailaccount['quotausage_rel']}%" }<
                %span<
                  - q_usage = mailaccount['quotausage']
                  - if q_usage.is_a?(Fixnum)
                    = Filesize.from("#{mailaccount['quotausage']} B").pretty
                  - else
                    N/A
          %td.number{ style: 'text-align: right;' }<= quota_pretty
          %td<
            %a.icon.item-delete.icon-trash{ href: a_del }= ' delete'
