.table-wrapper
  %table.table.table-triped
    %caption Mailaccounts
    %thead
      %tr
        %th<
          enabled
        %th<
          email
        %th<
          realname
        %th<
          receiving
        %th<
          usage
        %th<
          quota
        %th<
    %tbody
      -# - policy_scope(MailAccount).each do |mailaccount|
      - @mailaccounts.each do |mailaccount|
        - id = mailaccount['id']
        - edit_link = "/mail/accounts/#{id}/edit"
        %tr
          %td.icon<
            - en = 'icon-check item-enabled'
            - dis = 'icon-cross item-disabled'
            - enable_class_suffix = mailaccount['enabled'] ? en : dis
            - enable_link_text = mailaccount['enabled'] ? 'yes' : 'no'
            %a{ href: edit_link,
              class: "icon #{enable_class_suffix}" }= enable_link_text
          %td<
            %a{ href: edit_link }<
              = mailaccount['email']
          %td<= mailaccount['realname']
          %td.icon<
            - en = 'icon-check item-enabled'
            - dis = 'icon-cross item-disabled'
            - en_recv_class_suf = mailaccount['receiving_enabled'] ? en : dis
            - en_recv_link_txt = mailaccount['receiving_enabled'] ? 'yes' : 'no'
            %a{ href: edit_link,
              class: "icon #{en_recv_class_suf}" }= en_recv_link_txt
          %td<
            .progress
              - progress_class = 'progress-bar progress-bar-info'
              - thresh_warn = settings.threshholds[:display][:mailquota_warn]
              - thresh_crit = settings.threshholds[:display][:mailquota_crit]
              - if mailaccount['quotausage_rel'] >= thresh_warn
                - progress_class = 'progress-bar progress-bar-warning'
              - if mailaccount['quotausage_rel'] >= thresh_crit
                - progress_class = 'progress-bar progress-bar-danger'
              %div{ class: progress_class,
                    'role': 'progress',
                    'aria-valuemin': '0',
                    'aria-valuemax': '100',
                    style: "width:#{mailaccount['quotausage_rel']}%" }
                %span<
                  - q_usage = mailaccount['quotausage']
                  - if q_usage.is_a?(Fixnum)
                    = Filesize.from("#{mailaccount['quotausage']} B").pretty
                  - else
                    N/A
          %td.number<= Filesize.from("#{mailaccount['quota'].to_i} B").pretty
          %td.icon.item-delete<
            - delete_path = "/mail/accounts/#{id}/delete"
            %a.icon.icon-trash.item-delete{ href: delete_path }< delete
